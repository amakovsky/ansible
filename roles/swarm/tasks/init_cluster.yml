---
- name: Check if Swarm has already been Initialized
  command: docker info
  register: docker_info
  ignore_errors: true

- name: Initialize Docker Swarm
  command: "docker swarm init \
    --advertise-addr={{ inventory_hostname }}"
  when: "docker_info.stdout.find('Swarm: inactive') != -1"
  run_once: true

#- name: Get the Manager join-token
#  command: docker swarm join-token --quiet manager
#  register: manager_token

#- name: Get the worker join-token
#  command: docker swarm join-token --quiet worker
#  register: worker_token