{% if consul_role == 'server' %}
description "Consul server process"
{% else %}
description "Consul client process"
{% endif %}

start on (local-filesystems and net-device-up IFACE=eth0)
stop on runlevel [!12345]

respawn

setuid {{ consul_user }}
setgid {{ consul_user }}

{% if consul_role == 'server' %}
exec consul agent -config-dir /etc/consul.d/ --ui
{% else %}
exec consul agent -config-dir /etc/consul.d/
{% endif %}

